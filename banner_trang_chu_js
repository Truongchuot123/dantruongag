document.addEventListener("DOMContentLoaded", function () {
    const today = new Date();
    const day = today.getDate();
    const month = today.getMonth() + 1;
    const bannerTrangCon = document.querySelector(".banner_trangcon");
    const bannerHeader = document.querySelector(".banner_trangcon_header");
    const ngayGioToHungVuong = document.querySelector(".ngay_gio_to_hung_vuong");
    const ngaygiaiphongmiennam30_4 = document.querySelector(".banner_giai_phong_mien_nam_30-4");
    const ngaychienthangdienbienphu07_05 = document.querySelector(".banner_chien_thang_dien_bien_phu");
    const nggaysinhchutichHCM19_05 = document.querySelector(".banner_ngay_sinh_chu_tich_HCM_1905");
    const ngaysinhnhat_1807 = document.querySelector(".banner_ngay_sinh_nhat_1807");
    const ngaycachmangthangtam_1908 = document.querySelector(".banner_ngay_cach_mang_thang_tam");
    const ngayquockhanh_0209 = document.querySelector(".banner_ngay_quoc_khanh");
    if (day === 2 && month === 4) {     //Lấy banner giổ tổ hùng vương
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "block";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "none";
    } else if (day === 30 && month === 4) {     //Lấy banner ngày giải phóng miền nam thống nhất đất nước 
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "block";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "none";
    } else if (day === 7 && month === 5) {     //Lấy banner ngày kỉ niệm chiến thắng Điện Biên Phủ
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "block";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "none";
    } else if (day === 19 && month === 5) {     //Lấy banner ngày sinh chủ tịch Hồ Chí Minh
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "block";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "none";
    } else if (day === 18 && month === 7) {     //Lấy banner ngày sinh nhật
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "block";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "none";
    } else if (day === 19 && month === 8) {     //Lấy banner ngày cách mạng tháng tám
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "block";
        ngayquockhanh_0209.style.display = "none";
    } else if (day === 2 && month === 9) {     //Lấy banner ngày quốc khánh
        bannerTrangCon.style.display = "none";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "block";
    }
    else {                                     //Lấy banner ngày bình thuong
        bannerHeader.style.display = "block";
        ngayGioToHungVuong.style.display = "none";
        ngaygiaiphongmiennam30_4.style.display = "none";
        ngaychienthangdienbienphu07_05.style.display = "none";
        nggaysinhchutichHCM19_05.style.display = "none";
        ngaysinhnhat_1807.style.display = "none";
        ngaycachmangthangtam_1908.style.display = "none";
        ngayquockhanh_0209.style.display = "none";
        
    }
});
// Cập nhật ngày hiển thị trên trang
document.getElementById("current-date").innerHTML = `02.04.${today.getFullYear()}`;
// Hiệu ứng gõ chữ cho ngày Quốc tế Hạnh phúc
const text = "Hạnh phúc đến từ những điều giản dị nhất. Chúc bạn luôn vui vẻ, an nhiên và tràn đầy năng lượng!";
let index = 0;
const speed = 50;
function typeEffect() {
    const p = document.getElementById("typing-text");
    if (index < text.length) {
        p.textContent += text.charAt(index);
        index++;
        setTimeout(typeEffect, speed);
    }
}
setTimeout(typeEffect, 1000);

// Pháo hoa cho ngày 20/03
const canvas = document.getElementById("fireworks");
const ctx = canvas.getContext("2d");
function setCanvasSize() {
    const container = document.querySelector(".banner_2003");
    canvas.width = container.clientWidth;
    canvas.height = container.clientHeight;
}
window.addEventListener("resize", setCanvasSize);
setCanvasSize();

let particles = [];
function random(min, max) {
    return Math.random() * (max - min) + min;
}
class Particle {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = random(2, 4);
        this.speedX = random(-2, 2);
        this.speedY = random(-2, 2);
        this.color = `hsl(${random(0, 360)}, 100%, 60%)`;
        this.opacity = 1;
    }
    update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.opacity -= 0.02;
    }
    draw() {
        ctx.globalAlpha = this.opacity;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
    }
}
function createFirework() {
    const x = random(20, canvas.width - 20);
    const y = random(20, canvas.height - 20);
    for (let i = 0; i < 30; i++) {
        particles.push(new Particle(x, y));
    }
}
function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particles = particles.filter(p => p.opacity > 0);
    particles.forEach(p => {
        p.update();
        p.draw();
    });
    requestAnimationFrame(animate);
}
function launchFireworks() {
    setInterval(createFirework, 1000);
}
animate();
launchFireworks();

// Đếm ngược Giờ Trái Đất
function updateCountdown() {
    const eventDate = new Date("March 22, 2025 22:42:00").getTime(); // 9h20 tối
    const oneDayBefore = eventDate - 24 * 60 * 60 * 1000;
    const oneHourAfter = eventDate + 60 * 60 * 1000;
    const now = new Date().getTime();
    const timeLeft = eventDate - now;
    const bannerGioTraiDat = document.querySelector(".banner_gio_trai_dat");
    const bannerTrangConHeader = document.querySelector(".banner_trangcon_header");

    // Ẩn banner_trangcon_header trước sự kiện
    if (now < eventDate) {
        bannerTrangConHeader.style.display = "none";
    }

    if (now >= oneDayBefore && now < eventDate) {
        bannerGioTraiDat.style.display = "block";
        document.getElementById("earth-hour-message").style.display = "block";
        document.getElementById("earth-hour-message").innerText = "Giờ Trái Đất sắp diễn ra";
    }

    if (timeLeft > 0) {
        document.getElementById("days").innerText = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        document.getElementById("hours").innerText = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        document.getElementById("minutes").innerText = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        document.getElementById("seconds").innerText = Math.floor((timeLeft % (1000 * 60)) / 1000);
    } else if (now >= eventDate && now < oneHourAfter) {
        // Khi sự kiện bắt đầu (đúng 21:20)
        document.querySelector(".countdown").style.display = "none";
        document.getElementById("earth-hour-message").innerText = "HÃY TẮT ĐÈN NGAY BÂY GIỜ!";
        document.body.style.backgroundColor = "black";
    } else if (now >= oneHourAfter) {
        // Sau 1 giờ (đúng 22:20)
        bannerGioTraiDat.style.display = "none";
        bannerTrangConHeader.style.display = "block";
        document.body.style.backgroundColor = "white";
    }
}

setInterval(updateCountdown, 1000);
updateCountdown();